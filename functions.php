<?php
/**
 * CBL_Theme functions and definitions
 *
 * @link https://developer.wordpress.org/themes/basics/theme-functions/
 *
 * @package CBL_Theme
 */

if ( ! defined( '_S_VERSION' ) ) {
	// Replace the version number of the theme on each release.
	define( '_S_VERSION', '1.0.0' );
}

/**
 * Sets up theme defaults and registers support for various WordPress features.
 *
 * Note that this function is hooked into the after_setup_theme hook, which
 * runs before the init hook. The init hook is too late for some features, such
 * as indicating support for post thumbnails.
 */
function cbl_theme_setup() {
	/*
		* Make theme available for translation.
		* Translations can be filed in the /languages/ directory.
		* If you're building a theme based on CBL_Theme, use a find and replace
		* to change 'cbl_theme' to the name of your theme in all the template files.
		*/
	load_theme_textdomain( 'cbl_theme', get_template_directory() . '/languages' );

	// Add default posts and comments RSS feed links to head.
	add_theme_support( 'automatic-feed-links' );

	/*
		* Let WordPress manage the document title.
		* By adding theme support, we declare that this theme does not use a
		* hard-coded <title> tag in the document head, and expect WordPress to
		* provide it for us.
		*/
	add_theme_support( 'title-tag' );

	/*
		* Enable support for Post Thumbnails on posts and pages.
		*
		* @link https://developer.wordpress.org/themes/functionality/featured-images-post-thumbnails/
		*/
	add_theme_support( 'post-thumbnails' );

	// This theme uses wp_nav_menu() in one location.
	register_nav_menus(
		array(
			'menu-1' => esc_html__( 'Primary', 'cbl_theme' ),
		)
	);

	/*
		* Switch default core markup for search form, comment form, and comments
		* to output valid HTML5.
		*/
	add_theme_support(
		'html5',
		array(
			'search-form',
			'comment-form',
			'comment-list',
			'gallery',
			'caption',
			'style',
			'script',
		)
	);

	// Set up the WordPress core custom background feature.
	add_theme_support(
		'custom-background',
		apply_filters(
			'cbl_theme_custom_background_args',
			array(
				'default-color' => 'ffffff',
				'default-image' => '',
			)
		)
	);

	// Add theme support for selective refresh for widgets.
	add_theme_support( 'customize-selective-refresh-widgets' );

	/**
	 * Add support for core custom logo.
	 *
	 * @link https://codex.wordpress.org/Theme_Logo
	 */
	add_theme_support(
		'custom-logo',
		array(
			'height'      => 250,
			'width'       => 250,
			'flex-width'  => true,
			'flex-height' => true,
		)
	);
}
add_action( 'after_setup_theme', 'cbl_theme_setup' );

/**
 * Set the content width in pixels, based on the theme's design and stylesheet.
 *
 * Priority 0 to make it available to lower priority callbacks.
 *
 * @global int $content_width
 */
function cbl_theme_content_width() {
	$GLOBALS['content_width'] = apply_filters( 'cbl_theme_content_width', 640 );
}
add_action( 'after_setup_theme', 'cbl_theme_content_width', 0 );

/**
 * Register widget area.
 *
 * @link https://developer.wordpress.org/themes/functionality/sidebars/#registering-a-sidebar
 */
function cbl_theme_widgets_init() {
	register_sidebar(
		array(
			'name'          => esc_html__( 'Sidebar', 'cbl_theme' ),
			'id'            => 'sidebar-1',
			'description'   => esc_html__( 'Add widgets here.', 'cbl_theme' ),
			'before_widget' => '<section id="%1$s" class="widget %2$s">',
			'after_widget'  => '</section>',
			'before_title'  => '<h2 class="widget-title">',
			'after_title'   => '</h2>',
		)
	);
}
add_action( 'widgets_init', 'cbl_theme_widgets_init' );

/**
 * Enqueue scripts and styles.
 */
function cbl_theme_scripts() {
	wp_enqueue_style( 'cbl_theme-style', get_stylesheet_uri(), array(), _S_VERSION );
	wp_style_add_data( 'cbl_theme-style', 'rtl', 'replace' );

	wp_enqueue_script( 'cbl_theme-navigation', get_template_directory_uri() . '/js/navigation.js', array(), _S_VERSION, true );

	if ( is_singular() && comments_open() && get_option( 'thread_comments' ) ) {
		wp_enqueue_script( 'comment-reply' );
	}
}
add_action( 'wp_enqueue_scripts', 'cbl_theme_scripts' );


require get_template_directory() . '/inc/template-functions.php';




function cptui_register_my_cpts() {

	/**
	 * Post Type: Providers.
	 */

	$labels = [
		"name" => esc_html__( "Providers", "cbl_theme" ),
		"singular_name" => esc_html__( "Provider", "cbl_theme" ),
	];

	$args = [
		"label" => esc_html__( "Providers", "cbl_theme" ),
		"labels" => $labels,
		"description" => "",
		"public" => true,
		"publicly_queryable" => true,
		"show_ui" => true,
		"show_in_rest" => true,
		"rest_base" => "",
		"rest_controller_class" => "WP_REST_Posts_Controller",
		"rest_namespace" => "wp/v2",
		"has_archive" => true,
		"show_in_menu" => true,
		"show_in_nav_menus" => true,
		"delete_with_user" => false,
		"exclude_from_search" => true,
		"capability_type" => "post",
		"map_meta_cap" => true,
		"hierarchical" => true,
		"can_export" => true,
		"rewrite" => [ "slug" => "providers", "with_front" => true ],
		"query_var" => true,
		"supports" => [ "title", "editor", "thumbnail", "page-attributes" ],
		"show_in_graphql" => true,
		"graphql_single_name" => "Provider",
		"graphql_plural_name" => "Providers",
	];

	register_post_type( "providers", $args );

	/**
	 * Post Type: Zone.
	 */

	$labels = [
		"name" => esc_html__( "Zone", "cbl_theme" ),
		"singular_name" => esc_html__( "Zone", "cbl_theme" ),
	];

	$args = [
		"label" => esc_html__( "Zone", "cbl_theme" ),
		"labels" => $labels,
		"description" => "",
		"public" => true,
		"publicly_queryable" => true,
		"show_ui" => true,
		"show_in_rest" => true,
		"rest_base" => "",
		"rest_controller_class" => "WP_REST_Posts_Controller",
		"rest_namespace" => "wp/v2",
		"has_archive" => false,
		"show_in_menu" => true,
		"show_in_nav_menus" => true,
		"delete_with_user" => false,
		"exclude_from_search" => false,
		"capability_type" => "post",
		"map_meta_cap" => true,
		"hierarchical" => false,
		"can_export" => false,
		"rewrite" => [ "slug" => "area_zone", "with_front" => true ],
		"query_var" => true,
		"supports" => [ "title", "editor", "thumbnail" ],
		"show_in_graphql" => true,
		"graphql_single_name" => "Zone",
		"graphql_plural_name" => "Zone",
	];

	register_post_type( "area_zone", $args );
}

add_action( 'init', 'cptui_register_my_cpts' );





	function cptui_register_my_taxes() {

	/**
	 * Taxonomy: City.
	 */

	$labels = [
		"name" => esc_html__( "City", "cbl_theme" ),
		"singular_name" => esc_html__( "City", "cbl_theme" ),
	];

	
	$args = [
		"label" => esc_html__( "City", "cbl_theme" ),
		"labels" => $labels,
		"public" => true,
		"publicly_queryable" => true,
		"hierarchical" => false,
		"show_ui" => true,
		"show_in_menu" => true,
		"show_in_nav_menus" => true,
		"query_var" => true,
		"rewrite" => [ 'slug' => 'zone_city', 'with_front' => true, ],
		"show_admin_column" => true,
		"show_in_rest" => true,
		"show_tagcloud" => false,
		"rest_base" => "zone_city",
		"rest_controller_class" => "WP_REST_Terms_Controller",
		"rest_namespace" => "wp/v2",
		"show_in_quick_edit" => true,
		"sort" => true,
		"show_in_graphql" => true,
		"graphql_single_name" => "City",
		"graphql_plural_name" => "Cities",
	];
	register_taxonomy( "zone_city", [ "area_zone" ], $args );

	/**
	 * Taxonomy: State.
	 */

	$labels = [
		"name" => esc_html__( "State", "cbl_theme" ),
		"singular_name" => esc_html__( "State", "cbl_theme" ),
	];

	
	$args = [
		"label" => esc_html__( "State", "cbl_theme" ),
		"labels" => $labels,
		"public" => true,
		"publicly_queryable" => true,
		"hierarchical" => false,
		"show_ui" => true,
		"show_in_menu" => true,
		"show_in_nav_menus" => true,
		"query_var" => true,
		"rewrite" => [ 'slug' => 'zone_state', 'with_front' => true, ],
		"show_admin_column" => true,
		"show_in_rest" => true,
		"show_tagcloud" => false,
		"rest_base" => "zone_state",
		"rest_controller_class" => "WP_REST_Terms_Controller",
		"rest_namespace" => "wp/v2",
		"show_in_quick_edit" => true,
		"sort" => true,
		"show_in_graphql" => true,
		"graphql_single_name" => "State",
		"graphql_plural_name" => "States",
	];
	register_taxonomy( "zone_state", [ "area_zone" ], $args );

	/**
	 * Taxonomy: County.
	 */

	$labels = [
		"name" => esc_html__( "County", "cbl_theme" ),
		"singular_name" => esc_html__( "County", "cbl_theme" ),
	];

	
	$args = [
		"label" => esc_html__( "County", "cbl_theme" ),
		"labels" => $labels,
		"public" => true,
		"publicly_queryable" => true,
		"hierarchical" => false,
		"show_ui" => true,
		"show_in_menu" => true,
		"show_in_nav_menus" => true,
		"query_var" => true,
		"rewrite" => [ 'slug' => 'zone_county', 'with_front' => true, ],
		"show_admin_column" => true,
		"show_in_rest" => true,
		"show_tagcloud" => false,
		"rest_base" => "zone_county",
		"rest_controller_class" => "WP_REST_Terms_Controller",
		"rest_namespace" => "wp/v2",
		"show_in_quick_edit" => true,
		"sort" => true,
		"show_in_graphql" => true,
		"graphql_single_name" => "County",
		"graphql_plural_name" => "Countys",
	];
	register_taxonomy( "zone_county", [ "area_zone" ], $args );
}
add_action( 'init', 'cptui_register_my_taxes' );




function get_provider_terms ($id , $term) {

	// Get the post terms (categories or tags)
$terms = get_the_terms($id, $term); // Change 'category' to 'post_tag' for tags

if ($terms && !is_wp_error($terms)) {
    foreach ($terms as $term) {
        return $term->name ;
    }
}



}


function enqueue_theme_styles() {
  wp_enqueue_style('tailwind', get_template_directory_uri() . '/src/styles/main.css');
}
add_action('wp_enqueue_scripts', 'enqueue_theme_styles');









$meta_value_array = array('15401','19930','19939','19945','19947','19951','19958','19966','19967','19968','19970','19975','21811','21813','21849','21850','21852','21862','21871','21872','21874','23322','25702','27820','27845','27846','27847','27849','27854','27862','27867','27869','27872','27876','27877','27890','27897','27909','27910','27916','27917','27919','27921','27923','27924','27925','27928','27929','27932','27939','27941','27944','27947','27956','27957','27958','27962','27964','27965','27966','27967','27970','27973','27974','27976','27980','27983','27985','28720','30062','30096','30135','31010','31015','31023','31037','31055','31061','31083','31092','31201','31522','31539','31549','31601','31602','31603','31605','31606','31620','31622','31626','31627','31632','31635','31636','31637','31639','31641','31642','31643','31645','31647','31650','31698','31699','31701','31702','31703','31704','31705','31706','31707','31709','31714','31719','31721','31727','31728','31730','31739','31742','31744','31745','31746','31749','31750','31756','31757','31763','31765','31768','31771','31773','31774','31775','31776','31779','31781','31788','31789','31790','31791','31792','31793','31794','31795','31799','31801','31803','31804','31805','31806','31807','31808','31810','31815','31820','31825','31829','31901','31902','31903','31904','31905','31906','31907','31908','31909','31914','31917','31993','31995','31997','31998','31999','32233','32301','32303','32304','32305','32312','32320','32322','32323','32328','32330','32332','32333','32345','32346','32351','32352','32353','32401','32402','32403','32404','32405','32406','32407','32408','32409','32410','32413','32425','32428','32439','32444','32456','32459','32461','32462','32465','32466','32501','32502','32503','32504','32505','32506','32507','32508','32509','32511','32512','32513','32514','32524','32526','32530','32531','32536','32537','32540','32541','32547','32548','32549','32550','32561','32562','32563','32564','32566','32570','32571','32572','32583','32591','34133','34433','35204','35242','35244','35470','35481','35613','35620','35739','35741','35742','35748','35749','35750','35756','35757','35758','35759','35761','35763','35767','35773','35805','35806','35808','35810','35811','35814','35953','36092','36401','36426','36432','36439','36441','36445','36451','36460','36461','36475','36502','36504','36505','36507','36509','36511','36521','36522','36523','36525','36526','36527','36530','36532','36533','36535','36541','36542','36543','36544','36545','36547','36549','36551','36553','36555','36559','36560','36561','36564','36567','36571','36572','36575','36576','36578','36580','36582','36587','36590','36602','36603','36604','36605','36606','36607','36608','36609','36610','36611','36613','36617','36618','36619','36675','36693','36695','36720','36726','36744','36748','36769','36784','36925','37023','37028','37043','37058','37079','37175','37311','37334','37345','37923','38449','38455','38477','38488','38549','38556','38573','38863','38965','39339','39423','39452','39520','39521','39522','39556','39564','39572','39576','39577','39813','39817','39818','39819','39825','39827','39828','39834','39840','39842','39845','39846','39851','39866','39886','39897','40004','40069','40119','40143','40144','40145','40152','40160','40178','40204','40213','40216','40228','40241','40272','40291','40299','40324','40356','40409','40419','40456','40475','40509','41006','41073','41074','41075','42003','42020','42025','42029','42033','42036','42040','42044','42048','42049','42054','42064','42066','42071','42078','42082','42124','42129','42130','42140','42141','42160','42166','42167','42171','42207','42210','42211','42217','42220','42234','42240','42261','42262','42266','42285','42286','42343','42351','42366','42368','42378','42406','42411','42420','42431','42436','42441','42442','42445','42452','42528','42539','42565','42602','42603','42629','42633','42642','42701','42712','42713','42717','42721','42722','42726','42728','42729','42731','42746','42749','42754','42755','42759','42762','42765','42772','42776','42784','42787','43506','43526','44306','44857','45005','45042','45044','45050','45140','45162','45201','45202','45203','45204','45205','45206','45207','45208','45209','45211','45212','45213','45214','45215','45216','45217','45219','45220','45221','45222','45223','45224','45225','45226','45227','45229','45230','45232','45233','45234','45237','45238','45239','45248','45250','45263','45264','45267','45268','45269','45270','45271','45273','45274','45296','45298','45299','45335','45377','45401','45402','45403','45404','45405','45406','45409','45410','45412','45414','45416','45417','45419','45420','45422','45423','45424','45426','45428','45429','45431','45432','45439','45469','45479','45482','45490','45813','46217','46224','46310','46347','46348','46349','46356','46366','46368','46372','46374','46376','46377','46379','46381','46383','46384','46385','46390','46391','46392','46501','46504','46506','46511','46531','46534','46536','46537','46538','46542','46550','46554','46555','46562','46563','46567','46570','46574','46580','46581','46582','46701','46703','46706','46714','46721','46723','46725','46731','46732','46733','46737','46738','46741','46742','46743','46746','46748','46755','46761','46763','46765','46766','46767','46772','46774','46777','46779','46780','46781','46782','46784','46785','46787','46788','46791','46793','46794','46795','46801','46802','46803','46804','46805','46806','46807','46808','46809','46814','46815','46816','46818','46819','46825','46835','46845','46850','46851','46852','46853','46854','46855','46856','46857','46858','46859','46860','46861','46862','46863','46864','46865','46866','46867','46868','46869','46885','46895','46897','46898','46899','46943','46952','46962','47327','47348','47362','47373','47374','47383','47432','47922','47946','47948','47951','47957','48239','48933','49008','49009','49065','49067','49071','49072','49079','50001','50002','50003','50009','50010','50011','50012','50013','50014','50021','50022','50023','50025','50032','50035','50036','50037','50038','50044','50047','50049','50054','50060','50061','50062','50063','50067','50069','50070','50072','50073','50099','50109','50111','50112','50116','50118','50124','50125','50126','50131','50133','50138','50140','50142','50144','50150','50151','50153','50156','50158','50163','50169','50170','50201','50207','50208','50211','50213','50219','50220','50225','50226','50228','50231','50233','50237','50243','50244','50248','50249','50250','50251','50256','50261','50263','50265','50266','50268','50273','50275','50276','50301','50302','50303','50304','50305','50306','50307','50308','50309','50310','50311','50312','50313','50314','50315','50316','50317','50318','50319','50320','50321','50322','50323','50324','50325','50327','50328','50329','50330','50331','50332','50334','50335','50336','50339','50340','50359','50360','50361','50362','50363','50364','50367','50368','50369','50380','50381','50391','50392','50393','50394','50395','50396','50398','50401','50402','50421','50423','50424','50428','50436','50438','50441','50448','50451','50453','50456','50459','50461','50466','50469','50475','50482','50501','50511','50517','50518','50522','50524','50525','50526','50529','50533','50536','50541','50548','50554','50563','50566','50569','50574','50579','50583','50588','50590','50595','50601','50604','50609','50613','50614','50616','50621','50622','50624','50627','50628','50629','50630','50632','50634','50635','50638','50641','50643','50644','50647','50648','50651','50655','50659','50660','50661','50662','50665','50667','50669','50670','50674','50675','50677','50681','50701','50702','50703','50704','50706','50707','50801','50833','50841','50849','50854','50864','50936','50940','50947','50950','50980','50981','50982','50983','51002','51012','51201','51301','51331','51334','51345','51347','51351','51355','51360','51401','51442','51443','51449','51501','51503','51521','51534','51537','51566','51591','51593','51601','51632','51638','52001','52002','52003','52004','52039','52040','52042','52043','52045','52046','52048','52049','52052','52057','52060','52064','52068','52069','52070','52076','52099','52101','52132','52136','52141','52142','52144','52146','52151','52155','52157','52158','52160','52161','52168','52172','52175','52201','52203','52204','52205','52208','52224','52227','52228','52233','52235','52236','52240','52241','52242','52243','52244','52245','52246','52247','52248','52253','52301','52302','52307','52310','52314','52315','52316','52317','52318','52322','52323','52324','52327','52328','52329','52333','52334','52336','52338','52339','52340','52341','52342','52349','52353','52356','52358','52361','52362','52388','52401','52402','52403','52404','52405','52406','52407','52408','52409','52410','52411','52497','52498','52499','52501','52530','52531','52534','52537','52544','52553','52554','52556','52557','52577','52591','52595','52601','52623','52627','52632','52638','52639','52640','52641','52645','52653','52655','52656','52720','52722','52726','52728','52730','52731','52732','52733','52734','52736','52737','52738','52742','52747','52748','52750','52753','52755','52756','52757','52758','52767','52768','52772','52773','52776','52778','52801','52802','52803','52804','52805','52806','52807','52808','52809','53012','53022','53072','53121','53186','53187','53188','53189','53502','53504','53510','53516','53522','53530','53537','53548','53566','53570','53573','53576','53586','53587','53803','53805','53807','53809','53811','53820','53821','53948','53950','53960','54601','54602','54603','54618','54619','54621','54623','54624','54628','54631','54637','54639','54646','54648','54650','54651','54652','54655','54656','54658','54664','54665','54667','54670','54703','54940','54945','54956','54977','54990','55009','55016','55020','55026','55033','55041','55046','55054','55060','55066','55071','55072','55088','55089','55101','55102','55103','55104','55105','55106','55107','55108','55111','55114','55116','55117','55118','55119','55126','55130','55133','55145','55146','55150','55155','55164','55165','55166','55168','55170','55171','55172','55175','55305','55307','55310','55312','55314','55315','55317','55318','55323','55324','55325','55331','55332','55333','55334','55335','55339','55340','55342','55343','55344','55345','55346','55347','55348','55349','55350','55352','55354','55355','55356','55357','55359','55361','55364','55368','55369','55372','55373','55375','55378','55379','55381','55384','55385','55386','55387','55391','55393','55395','55396','55397','55401','55402','55403','55404','55405','55406','55407','55408','55409','55410','55411','55412','55413','55414','55415','55416','55417','55418','55419','55421','55422','55423','55427','55430','55437','55438','55440','55446','55450','55454','55455','55458','55459','55460','55467','55470','55472','55474','55478','55479','55480','55483','55484','55485','55486','55487','55488','55570','55571','55572','55574','55575','55576','55577','55578','55579','55592','55593','55601','55604','55614','55616','55705','55707','55708','55709','55713','55716','55718','55719','55720','55721','55722','55723','55730','55733','55734','55741','55744','55745','55746','55747','55750','55751','55753','55758','55764','55767','55768','55769','55777','55783','55786','55792','55802','55803','55804','55805','55806','55807','55808','55810','55811','55812','55814','55816','55901','55902','55904','55909','55917','55918','55919','55921','55922','55923','55925','55927','55929','55940','55941','55943','55946','55947','55949','55951','55953','55954','55955','55960','55962','55963','55965','55971','55972','55973','55974','55975','55976','55981','55982','55985','55990','56001','56011','56017','56028','56044','56048','56050','56054','56055','56058','56063','56069','56078','56081','56082','56085','56087','56091','56093','56096','56097','56098','56101','56120','56131','56136','56142','56144','56149','56151','56156','56159','56164','56172','56177','56178','56187','56208','56209','56215','56221','56222','56225','56226','56228','56230','56232','56240','56241','56243','56244','56256','56260','56267','56270','56277','56283','56289','56296','56301','56312','56316','56334','56362','56381','57002','57006','57007','57017','57024','57026','57028','57054','57071','57078','57212','57220','57223','57231','57233','57234','57241','57248','57249','57276','57732','60001','60012','60033','60034','60071','60072','60081','60109','60112','60115','60118','60119','60134','60136','60140','60144','60145','60146','60150','60151','60407','60420','60424','60447','60450','60460','60474','60502','60503','60504','60505','60506','60507','60510','60511','60518','60520','60531','60538','60542','60545','60550','60551','60552','60554','60556','60563','60564','60568','60569','60585','60598','60599','60921','60928','60929','60935','60936','60940','60948','60949','60952','60954','60957','60958','60966','60970','60974','61001','61008','61011','61012','61014','61016','61018','61019','61020','61024','61025','61028','61036','61038','61039','61041','61046','61048','61050','61051','61052','61053','61060','61062','61063','61065','61067','61068','61070','61074','61075','61078','61085','61087','61088','61089','61101','61102','61103','61104','61105','61106','61107','61108','61109','61110','61112','61114','61115','61201','61204','61230','61231','61232','61233','61234','61235','61236','61238','61239','61240','61241','61242','61244','61250','61252','61254','61256','61257','61261','61262','61263','61264','61265','61270','61273','61274','61275','61276','61277','61278','61279','61281','61282','61283','61284','61285','61299','61301','61314','61315','61319','61326','61327','61338','61340','61341','61344','61345','61350','61358','61361','61363','61364','61369','61373','61375','61376','61377','61379','61401','61410','61412','61414','61415','61421','61432','61434','61438','61439','61440','61441','61453','61454','61455','61458','61468','61469','61470','61473','61474','61480','61483','61484','61485','61486','61488','61489','61490','61491','61501','61516','61517','61520','61523','61524','61525','61529','61530','61531','61533','61534','61536','61537','61540','61544','61547','61548','61552','61559','61561','61562','61563','61565','61570','61571','61572','61602','61607','61610','61611','61614','61635','61701','61704','61705','61709','61710','61723','61724','61726','61727','61728','61731','61732','61733','61734','61736','61738','61739','61741','61742','61744','61745','61747','61748','61751','61752','61753','61754','61755','61759','61760','61764','61769','61770','61771','61774','61776','61777','61778','61791','61799','61801','61802','61803','61813','61818','61820','61821','61822','61824','61825','61826','61839','61840','61842','61843','61847','61851','61853','61854','61855','61856','61858','61863','61866','61873','61875','61878','61880','61882','61910','61911','61912','61913','61919','61920','61924','61928','61929','61930','61931','61933','61938','61943','61951','61953','61956','61957','62017','62051','62071','62088','62093','62201','62202','62203','62204','62205','62207','62208','62220','62232','62234','62237','62248','62278','62285','62286','62292','62321','62330','62341','62354','62379','62401','62411','62420','62423','62428','62431','62433','62441','62442','62447','62449','62451','62454','62458','62461','62462','62463','62464','62465','62467','62468','62474','62515','62517','62520','62531','62538','62540','62545','62546','62547','62553','62555','62556','62561','62568','62570','62571','62611','62625','62628','62629','62634','62635','62642','62643','62650','62651','62661','62666','62670','62671','62682','62685','62701','62702','62703','62704','62705','62706','62707','62708','62711','62712','62715','62716','62721','62722','62723','62726','62736','62739','62756','62757','62761','62762','62763','62764','62766','62767','62769','62776','62777','62781','62786','62791','62794','62796','62812','62824','62832','62838','62858','62865','62896','62901','62902','62903','62905','62906','62915','62918','62920','62921','62922','62924','62927','62930','62932','62933','62946','62948','62949','62951','62958','62959','62963','62964','62965','62966','62983','62999','63102','63830','63851','64024','64036','64062','64084','64085','64402','64424','64429','64633','64658','64660','64668','64724','64725','64730','64730','64748','64755','64759','64762','64763','64776','64801','64801','64802','64803','64804','64830','64831','64834','64835','64840','64841','64843','64844','64849','64855','64857','64862','64866','64870','65041','65043','65101','65107','65109','65111','65201','65202','65203','65205','65211','65212','65215','65216','65217','65218','65236','65281','65604','65608','65610','65619','65623','65625','65633','65646','65647','65653','65657','65661','65682','65686','65689','65704','65705','65706','65707','65708','65712','65721','65723','65725','65734','65742','65746','65752','65757','65770','65781','65801','65802','65803','65804','65805','65806','65807','65808','65809','65810','65814','65890','65897','65898','65899','66006','66021','66092','66413','66414','66451','66523','66537','66547','66710','66739','66756','66776','66777','66839','66852','66853','66856','66857','66860','67045','67356','68144','68310','70809','74335','85020','85117','85118','85119','85120','85140','85142','85143','85202','85204','85206','85207','85208','85218','85219','85220','85240','85242','85243','85298','85321','85621','85628','85648','85662','91020','91046','91201','91202','91203','91204','91205','91206','91207','91208','91209','91210','91214','91221','91222','91224','91225','91226','91393','91501','91764','92061','92082','92308','92530','92531','92532','92539','92545','92562','92563','92570','92571','92584','92585','92586','92587','92592','92595','92596','93205','93238','93240','93255','93283','93285','93527','93542','93555','93556','93592','94403','95422','95423','95424','95425','95426','95435','95443','95451','95453','95457','95458','95461','95462','95464','95467','95485');
$post_id = 11911; 
$meta_key = 'internet_serices';
//update_post_meta($post_id, $meta_key, $meta_value_array);






function change_meta_keys_on_theme_activation() {
    global $wpdb;

    $old_meta_key = 'internet_serices';
    $new_meta_key = 'internet_services';

    $wpdb->update(
        $wpdb->postmeta,
        array('meta_key' => $new_meta_key),
        array('meta_key' => $old_meta_key)
    );
}
add_action('after_switch_theme', 'change_meta_keys_on_theme_activation');



	function custom_rest_endpoint_init() {
		register_rest_route('custom/v1', '/providers', array(
			'methods' => 'GET',
			'callback' => 'custom_rest_endpoint_callback',
		));
	}
	add_action('rest_api_init', 'custom_rest_endpoint_init');

		function custom_rest_endpoint_callback($request) {
		$params = $request->get_params();
		$response = array();
		if (!empty($params['internet_services'])) {
			$values = explode(',', $params['internet_services']);
			$values = array_map('trim', $values);
			$meta_query = array(
				'relation' => 'OR',
			);
			foreach ($values as $value) {
				$meta_query[] = array(
					'key'     => 'internet_services',
					'value'   => $value,
					'compare' => 'LIKE',
				);
			}
			$query_args = array(
				'post_type' => 'providers',
				'meta_query' => $meta_query,
			);
			$providers = get_posts($query_args);
			$response['providers'] = $providers;
		}
		return rest_ensure_response($response);
	}



// http://localhost/clients/cbl/wp-json/custom/v1/providers?internet_services=2001,2002

//https://cblproject.aspactglobal.com/wp-json/custom/v1/providers?internet_services=2001,2002











